(()=>{var t={332:()=>{AFRAME.registerSystem("aim",{init:function(){this._entities=[],this._frustum=new THREE.Frustum},play:function(){this.paused=!1},pause:function(){this.paused=!0},tick:function(){if(!this.paused&&this._entities.length>0){this._camera=this.el.sceneEl.camera,this._containerWidth=window.innerWidth,this._containerHeight=window.innerHeight;let t=new THREE.Vector3(0,0,-1*(this._camera.near+this._camera.far/2));this._camera.localToWorld(t);let e=1.05,i=this._containerWidth*e,n=this._containerHeight*e,r=-1*(i-this._containerWidth),s=-1*(n-this._containerHeight);this._entities.filter((t=>!t.components.aim.paused)).forEach(((e,o,a)=>{let l=this._getEntityCenterPoint(e);if(l&&!this._checkIsAtScreen(this._camera,l)){let o=new THREE.Line3;o.set(t,l);let a=new THREE.Vector3,c=!1;for(let t=0;t<this._frustum.planes.length;t++)if(this._frustum.planes[t].intersectLine(o,a),a){let t=this._vector3ToScreenXY(this._camera,a,this._containerWidth,this._containerHeight);if(t&&(t.x<0&&t.x>=r&&(t.x=0),t.y<0&&t.y>=s&&(t.y=0),t.x>this._containerWidth&&t.x<=i&&(t.x=this._containerWidth),t.y>this._containerHeight&&t.y<=n&&(t.y=this._containerHeight),c=t.x>=0&&t.y>=0&&t.x<=this._containerWidth&&t.y<=this._containerHeight,c)){let i=this._findAimPointerAngle(t,this._containerWidth,this._containerHeight);this._placePointer(e,t,i),e.components.aim.pointerEl.classList.toggle("visible",!0)}}}else e.components.aim.pointerEl.classList.toggle("visible",!1)}))}},registerEntity:function(t){this._entities.push(t)},unregisterEntity:function(t){let e=this._entities.indexOf(t);this._entities.splice(e,1)},_checkIsAtScreen:function(t,e){return this._frustum.setFromProjectionMatrix((new THREE.Matrix4).multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse)),this._frustum.containsPoint(e)},_vector3ToScreenXY:function(t,e,i,n){let r=null,s=e.clone(),o=new THREE.Matrix4;o.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),s.applyMatrix4(o);let a=(s.x+1)*i/2,l=(1-s.y)*n/2;return isNaN(a)||isNaN(l)||(r={x:a,y:l}),r},_findAimPointerAngle:function(t,e,i){let n=t.x,r=i/2-t.y,s=e/2-n,o=Math.atan2(r,s);return o*=180/Math.PI,o<0&&(o=360+o),o},_placePointer:function(t,e,i){t.components.aim.pointerEl.style.left=`${e.x}px`,t.components.aim.pointerEl.style.top=`${e.y}px`,t.components.aim.pointerEl.style.transformOrigin="0% 0%",t.components.aim.pointerEl.style.transform=`rotate(${i}deg) translate(0%, -50%)`},_getEntityCenterPoint:function(t){let e=null;if(t){let r=t.object3DMap.mesh;var i=r.geometry;i.computeBoundingBox();var n=new THREE.Vector3;i.boundingBox.getCenter(n),r.localToWorld(n),e=n}return e}}),AFRAME.registerComponent("aim",{schema:{color:{type:"color",default:"orange"},glyph:{type:"string",default:"â—„"}},init:function(){let t=document.createElement("div");t.setAttribute("class","aim-arrow"),this.pointerEl=t,document.querySelector("body").appendChild(this.pointerEl),this.system.registerEntity(this.el)},update:function(t){this.pointerEl.style.color=this.data.color,this.pointerEl.textContent=this.data.glyph},play:function(){this.paused=!1},pause:function(){this.paused=!0,this.pointerEl.classList.toggle("visible",!1)},remove:function(){this.system.unregisterEntity(this.el),this.pointerEl.parentElement.removeChild(this.pointerEl)}})}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var s=e[n]={exports:{}};return t[n](s,s.exports,i),s.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";i(332)})()})();